<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Office Locations Map</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .gm-style-iw {
      font-size: 14px;
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <div id="map"></div>

  <script>
    async function initMap() {
      try {
        // üëâ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô URL ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö GitHub Pages ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
        const response = await fetch("https://nitiponit69.github.io/Locationoffice/data.json");
        if (!response.ok) throw new Error("‡πÇ‡∏´‡∏•‡∏î data.json ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ");
        
        const locations = await response.json();

        if (locations.length === 0) {
          alert("‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô data.json");
          return;
        }

        // ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡πÅ‡∏£‡∏Å
        const map = new google.maps.Map(document.getElementById("map"), {
          zoom: 6,
          center: { lat: locations[0].Latitude, lng: locations[0].Longitude }
        });

        const bounds = new google.maps.LatLngBounds();

        locations.forEach(loc => {
          const marker = new google.maps.Marker({
            position: { lat: loc.Latitude, lng: loc.Longitude },
            map,
            title: loc.Name
          });

          const info = new google.maps.InfoWindow({
            content: `<b>${loc.Name}</b><br>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö: ${loc.‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö || "-"}`
          });

          marker.addListener("click", () => {
            info.open(map, marker);
          });

          bounds.extend(marker.position);
        });

        // ‡∏õ‡∏£‡∏±‡∏ö map ‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö marker ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
        map.fitBounds(bounds);

      } catch (err) {
        console.error(err);
        document.body.innerHTML = "<h2 style='color:red;text-align:center;'>‚ùå ‡πÇ‡∏´‡∏•‡∏î‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö data.json ‡∏´‡∏£‡∏∑‡∏≠ API Key</h2>";
      }
    }
  </script>

  <!-- üëâ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏≠‡∏á -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAEok84ylOVMh6c30ef4pZc-IzxBAbDz7w&callback=initMap"></script>
</body>
</html>
